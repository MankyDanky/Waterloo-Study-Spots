{"ast":null,"code":"import _objectSpread from\"/Users/aadikulsh/Documents/JS Projects/Waterloo Study Spots/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{ThemeContext,AccountContext}from\"./App\";import{useState,useContext,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Profile(){const{account,setAccount}=useContext(AccountContext);const{theme}=useContext(ThemeContext);const[accountDetails,setAccountDetails]=useState({icon:null,email:\"\",username:\"\"});const[newIcon,setNewIcon]=useState(null);const[error,setError]=useState(\"\");const[submitting,setSubmitting]=useState(false);async function submitIcon(e){setSubmitting(true);const formData=new FormData();formData.append(\"file\",newIcon);try{const imageData=await fetch(\"/api/uploadImage\",{method:\"POST\",body:formData}).then(res=>res.json());if(imageData.error){setNewIcon(null);setError(\"Unsupported file type.\");setSubmitting(false);}else{const iconChangeDetails={username:account.username,icon:imageData.link};const upload=await fetch(\"/api/changeIcon\",{method:\"POST\",headers:{'Content-Type':'application/json'},body:JSON.stringify(iconChangeDetails)});const newAccount=_objectSpread(_objectSpread({},account),{},{icon:imageData.link});setAccount(newAccount);localStorage.setItem(\"account\",JSON.stringify(newAccount));setSubmitting(false);setNewIcon(null);}}catch(error){console.log(error);}}useEffect(()=>{if(account){try{fetch(\"/api/getUser\",{method:\"POST\",headers:{'Content-Type':'application/json'},body:JSON.stringify({username:account.username})}).then(res=>res.json()).then(data=>{if(data.status==\"error\"){}else{setAccountDetails({icon:data.icon,email:data.email,username:data.username});}});}catch(error){console.log(error);}}},[account]);return!account?/*#__PURE__*/_jsx(\"h1\",{className:\"\".concat(theme,\"Text\"),style:{marginTop:\"40vh\",fontFamily:\"Barlow Condensed\",fontSize:\"10vh\",fontWeight:\"bold\"},children:\"Please login\"}):/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"10vh\",display:\"flex\",height:\"90vh\",alignItems:\"center\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{width:\"55vw\",display:\"block\"},children:[/*#__PURE__*/_jsx(\"img\",{src:newIcon?URL.createObjectURL(newIcon):accountDetails.icon,style:{objectFit:\"cover\",width:\"25vw\",height:\"25vw\",borderRadius:\"12.5vw\"}}),newIcon?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\"},children:[/*#__PURE__*/_jsx(\"button\",{className:\"Button \".concat(theme,\"Text \").concat(theme,\"Background4\"),style:{margin:\"1vw\",marginLeft:\"auto\"},onClick:()=>setNewIcon(null),children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"Button \".concat(theme,\"Text accentBackground\"),style:{margin:\"1vw\",marginRight:\"auto\",opacity:submitting?\"50%\":\"100%\",cursor:submitting?\"not-allowed\":\"pointer\"},onClick:submitIcon,disabled:submitting?true:false,children:\"Submit\"})]})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"imageUpload\",className:\"Button \".concat(theme,\"Text \").concat(theme,\"Background4\"),style:{display:\"block\",margin:\"auto\",marginTop:\"1vw\"},children:\"Change Icon\"}),/*#__PURE__*/_jsx(\"input\",{id:\"imageUpload\",accept:\"image/*\",type:\"file\",style:{visibility:\"hidden\"},onChange:event=>{setNewIcon(event.target.files[0]);}})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"accentText RegError\",children:error})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(theme,\"Text\"),style:{textAlign:\"left\",width:\"55vw\"},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:\"5vw\",fontFamily:\"Barlow Condensed\",fontWeight:\"bold\"},children:accountDetails.username}),/*#__PURE__*/_jsx(\"h2\",{style:{fontSize:\"2.3vw\",fontFamily:\"Verdana\",fontWeight:\"bold\"},children:accountDetails.email})]})]});}export default Profile;","map":{"version":3,"names":["ThemeContext","AccountContext","useState","useContext","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Profile","account","setAccount","theme","accountDetails","setAccountDetails","icon","email","username","newIcon","setNewIcon","error","setError","submitting","setSubmitting","submitIcon","e","formData","FormData","append","imageData","fetch","method","body","then","res","json","iconChangeDetails","link","upload","headers","JSON","stringify","newAccount","_objectSpread","localStorage","setItem","console","log","data","status","className","concat","style","marginTop","fontFamily","fontSize","fontWeight","children","display","height","alignItems","width","src","URL","createObjectURL","objectFit","borderRadius","justifyContent","margin","marginLeft","onClick","marginRight","opacity","cursor","disabled","htmlFor","id","accept","type","visibility","onChange","event","target","files","textAlign"],"sources":["/Users/aadikulsh/Documents/JS Projects/Waterloo Study Spots/client/src/Profile.js"],"sourcesContent":["import { ThemeContext, AccountContext} from \"./App\";\nimport {useState, useContext, useEffect} from 'react';\n\nfunction Profile() {\n    const {account, setAccount} = useContext(AccountContext);\n    const {theme} = useContext(ThemeContext);\n    const [accountDetails, setAccountDetails] = useState({icon: null, email: \"\", username: \"\"})\n    const [newIcon, setNewIcon] = useState(null)\n    const [error, setError] = useState(\"\")\n    const [submitting, setSubmitting] = useState(false)\n\n    async function submitIcon(e) {\n        setSubmitting(true)\n        const formData = new FormData();\n        formData.append(\"file\", newIcon);\n\n        try {\n            const imageData = await fetch(\"/api/uploadImage\", {\n                method: \"POST\",\n                body: formData,\n            }).then((res) => res.json());\n            if (imageData.error) {\n                setNewIcon(null);\n                setError(\"Unsupported file type.\")\n                setSubmitting(false)\n            } else {\n                const iconChangeDetails = {username: account.username, icon: imageData.link}\n                const upload = await fetch(\"/api/changeIcon\", \n                    {\n                        method: \"POST\", \n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        body: JSON.stringify(iconChangeDetails)\n                    })\n                const newAccount = {...account, icon: imageData.link}\n                setAccount(newAccount)\n                localStorage.setItem(\"account\", JSON.stringify(newAccount))\n                setSubmitting(false);\n                setNewIcon(null);\n            }\n            \n        } catch (error) {\n            console.log(error);\n        }\n        \n    }\n\n    useEffect(()=> {\n        if (account) {\n            try {\n                fetch(\"/api/getUser\", {\n                    method: \"POST\", \n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({username: account.username})\n                })\n                .then((res) => res.json()).then((data) => {\n                    if (data.status == \"error\") {\n                    } else {\n                        setAccountDetails({icon: data.icon, email: data.email, username: data.username})\n                    }\n                });\n            } catch (error) {\n                console.log(error);\n            }\n        }  \n    }, [account])\n\n    return (!account? <h1 className={`${theme}Text`}style={{marginTop: \"40vh\", fontFamily: \"Barlow Condensed\", fontSize: \"10vh\", fontWeight: \"bold\"}}>Please login</h1>:\n        <div style={{marginTop: \"10vh\", display: \"flex\", height: \"90vh\", alignItems: \"center\"}}>\n            <div style={{width: \"55vw\", display: \"block\"}}>\n                <img src={newIcon? URL.createObjectURL(newIcon) : accountDetails.icon} style={{objectFit: \"cover\", width: \"25vw\", height: \"25vw\", borderRadius: \"12.5vw\"}}></img>\n                \n                {newIcon? \n                <>\n                <div style={{display: \"flex\", justifyContent: \"center\"}}>\n                    <button className={`Button ${theme}Text ${theme}Background4`} style={{margin: \"1vw\", marginLeft: \"auto\"}} onClick={() => setNewIcon(null)}>Cancel</button>\n                    <button className={`Button ${theme}Text accentBackground`} style={{margin: \"1vw\", marginRight: \"auto\", opacity: (submitting? \"50%\": \"100%\"), cursor: (submitting? \"not-allowed\":\"pointer\")}} onClick={submitIcon} disabled={submitting? true: false}>Submit</button>\n                </div>\n                </>\n                :\n                <>\n                    <label htmlFor=\"imageUpload\" className={`Button ${theme}Text ${theme}Background4`} style={{display: \"block\", margin: \"auto\", marginTop: \"1vw\"}}>Change Icon</label>\n                    <input id=\"imageUpload\" accept=\"image/*\" type=\"file\" style={{visibility: \"hidden\"}} onChange={(event) => {\n                        setNewIcon(event.target.files[0]);\n                    }}></input>\n                </>\n                }\n                \n                {error && <p className={`accentText RegError`}>{error}</p>}\n            </div>\n            <div className={`${theme}Text`} style={{textAlign: \"left\", width: \"55vw\"}}>\n                <h1 style={{fontSize: \"5vw\", fontFamily: \"Barlow Condensed\", fontWeight: \"bold\"}}>{accountDetails.username}</h1>\n                <h2 style={{fontSize: \"2.3vw\", fontFamily: \"Verdana\", fontWeight: \"bold\"}}>{accountDetails.email}</h2>\n            </div>\n        </div>\n    )\n}\n\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}